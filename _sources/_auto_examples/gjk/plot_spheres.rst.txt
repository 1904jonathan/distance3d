
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "_auto_examples/gjk/plot_spheres.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download__auto_examples_gjk_plot_spheres.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr__auto_examples_gjk_plot_spheres.py:


=================================
Distance between spheres with GJK
=================================

.. GENERATED FROM PYTHON SOURCE LINES 6-41



.. image-sg:: /_auto_examples/gjk/images/sphx_glr_plot_spheres_001.png
   :alt: plot spheres
   :srcset: /_auto_examples/gjk/images/sphx_glr_plot_spheres_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none


    2.0657073492999247
    0.0
    0.5280306783837614
    0.0
    0.13979418785567044
    0.7313904397305826
    1.6809381731139517
    0.2623716327826636
    1.5208357085782809
    0.49127152618040804
    0.32092614880872655
    0.6536413029917519
    0.0
    0.7114752706133556
    0.6161940379307594
    0.12881622520477579
    0.20493386496421392
    1.3008037073309275
    0.0
    0.3235426243596007
    1.0572382209607865
    0.7193311800395742
    0.873362974435853
    1.130884326881744
    0.3631265912558383
    0.5887167976540062
    0.0
    0.8612727714343154
    1.576712148205994
    1.343553402205369
    2.195868634768677
    0.0
    0.4869621313995179
    0.3898101080056879
    0.80096031140387
    0.09146418257039698
    0.0
    1.4131058870485727
    1.1980296415155534
    0.8374618989615796
    0.5226039070334613
    0.07537605712071165
    0.4621043084056834
    0.0
    0.1574787503722209
    0.0
    0.08605108106629548
    0.7540669399061884
    1.4924391954089433
    1.2838710476769095
    1.123666481073194
    0.5376194779012711
    0.0
    0.7150721562009253
    0.0
    1.1363019094016187
    0.7140688492950569
    0.0
    2.8962731597817135
    0.46110027927847086
    0.0
    0.0
    0.0
    0.5003499164374033
    0.2641820741366592
    0.0
    1.179241907856338
    0.4445090561407108
    0.6130415533420136
    1.3377758580719519
    0.0975676924945211
    1.3842711210299896
    0.0
    0.6562877527747015
    0.0
    0.7012872588177669
    0.5492910976946555
    0.731704280038082
    0.0
    0.412945703254175
    0.13138231541270695
    0.0
    0.0
    0.0
    0.23891495143879687
    0.0
    0.0
    0.7296761227614827
    0.0
    0.14198856349715153
    1.2896855966213383
    1.0989712315222828
    1.202230652454926
    0.19069649634053032
    0.0
    0.4009695021950557
    0.01904012407894729
    0.18064576513671382
    0.5240535611222581
    0.0
    0.4349779598481595
    0.0
    0.0
    1.8829231756652716
    1.267281660495013
    0.6361579437652679
    0.0
    0.3594805001887424
    1.1813824897072203
    0.7400021017397717
    0.0
    1.0036211864471567
    0.9072133927870649
    1.075626669688077
    0.0
    1.6320939200757367
    1.5516002147000993
    0.4481231606678806
    0.0
    0.0
    0.1560897611832724
    0.0
    2.394370398277933
    0.5414689215066112
    0.6048861718582725
    2.8438118925368188
    1.411394784951918
    1.0522423362231335
    0.0
    0.710218787258745
    2.375029885602641
    0.40506362657360234
    0.0
    1.7822592768854972
    0.0
    0.0
    0.7981819950824387
    0.9032137166114437
    1.0474506704950866
    0.0
    1.5972873673571426
    0.6074627519217325
    0.08422937905609505
    1.6045474801866058
    0.0
    0.0
    0.6641629436137079
    2.0838199993941995
    0.5303630858290876
    1.8050037406410613
    1.050304622879891
    1.3901750563169117
    0.977453606587232
    0.0
    0.09083085303415345
    1.404606328862189
    1.027932947109521
    0.0
    0.3573406913356053
    1.2022937998470287
    0.0
    0.6350906439888544
    0.617032004424716
    0.0
    0.9774230227497923
    0.0661440019454207
    2.012118245814439
    0.3192341933810509
    0.0544718720651909
    0.7308629504023062
    0.22636360995407082
    0.9761953295783851
    1.321155789147141
    0.0
    0.03613499631781899
    0.4482820694584953
    0.0
    1.3453968967096728
    1.5124003015247531
    1.2323979314010107
    0.575828530791431
    2.678534736849973
    1.279397301818608
    1.3597153385155305
    0.027923902688881515
    1.1096568120925006
    1.3291272472960438
    0.3728914472004893
    0.0
    0.3091069364511897
    0.537012447152866
    0.0
    0.48623496106937797
    0.0
    1.583626120056075
    0.1590517000409007
    1.730892882681033
    0.6530106189069241
    0.35146539913339037
    1.1551815482869536
    0.9451871702355266
    0.023940749705257017
    1.5882106203801138
    0.17330639524238337
    0.0
    0.0
    2.219323824043925
    0.35155587936157356
    0.5824619916991
    0.24185201160873027
    0.26019122023468483
    0.1537454579338057
    1.4324743773222026
    1.1399237599073118
    0.7926344230066048
    0.2999946101551363
    0.0
    0.2129467151177489
    0.6448311641097098
    1.0113761016251586
    0.1477583228075055
    0.5204113597261729
    0.0
    0.03414976198333054
    0.07047942650322325
    2.01191111603733
    0.9208789733031523
    0.6938234142319134
    0.49231579055807023
    0.0
    1.0693304458816308
    0.0
    0.2616066261860092
    0.6578663261049029
    0.6333333937962914
    0.01914089926541473
    1.1263063841297216
    1.7269166755692844
    1.029120484521705
    1.0644199452149181
    0.3149765892341919
    0.522925860964482
    1.2914882990019951
    0.0
    0.0
    0.0
    1.1358718208742595
    0.0
    1.499219281927301
    0.3022476813372124
    0.0
    0.4144727787051406
    0.4994471313199279
    0.0
    0.6615498042356968
    0.0
    0.6752489279920433
    0.24328517008881417
    0.7589369569254595
    0.0020258603579295822
    0.11634588785982886
    0.3261740877651618
    0.4389434682791768
    0.30265917453214536
    0.0
    0.0
    0.49511418079639996
    1.0125988183244607
    0.4585586751807776
    0.6377533430858778
    1.2379724132703382
    0.7883296958481387
    1.4528234880250688
    0.36916946320412286
    0.874739030932987
    1.750784894911395
    0.26498729702839663
    0.0
    0.5608718254727083
    2.239367831659204
    0.0
    0.7180289629885923
    1.353987481042474
    0.0
    1.1408360218538698
    0.056303769024402005
    0.13412965429988
    0.0
    0.8847755631097064
    0.0
    1.2539117359362166
    0.0
    0.41190657365297756
    0.039290913809450385
    0.0
    2.196466863907047
    0.8408655706060841
    0.725434709629932
    1.5605917090105244
    1.6925376942816523
    0.0
    0.7825447920223018
    1.7293430353029262
    0.0
    0.001123162190713076
    0.0
    0.5883540161499224
    0.47703580516451644
    0.045978695449456576
    0.0
    0.9516919633903237
    0.0
    0.0
    1.032925090270386
    0.21036884636256956
    0.6171384650842923
    0.0
    0.8244625834202481
    0.4880483867650446
    0.3464947544826377
    1.2610286295947133
    0.0
    0.24847502216622375
    0.5303469195483926
    0.0
    0.2853360199731479
    0.007084537056502063
    0.06321714371008129
    2.04568725305992
    1.7479219510271196
    0.12635637842747782
    0.0
    1.5091620360301699
    2.5588269598191244
    0.06762265853727849
    1.075331869418642
    1.3629868410261488
    1.6581348030498655
    0.46482560121656735
    0.9153217465018799
    1.2601093810795847
    0.9165459849438577
    0.0
    0.0
    0.5655815459861321
    1.3564085933428607
    0.0
    0.0
    0.2565891916265293
    0.0
    0.0
    0.006347911565961983
    0.43621092122875604
    0.33105273123063383
    0.0
    1.2694582950660402
    0.4152638215811431
    0.0
    0.37693986097429805
    0.32597871208600304
    3.0199936792283246
    0.7165364000549711
    0.1396360074663842
    1.2146595883078255
    0.10197113862374697
    0.0
    1.031336497371115
    0.3191448145483093
    0.0
    0.2400508868478795
    0.4580290528079702
    0.0
    1.6710048405190914
    1.2680527939682074
    1.409248109176414
    0.23304373874011733
    0.3594356194473328
    0.5894376963760142
    1.6075727555065122
    2.371017543568354
    0.8492644751106572
    0.1273784877026335
    1.8071186864138535
    0.5831962289122944
    0.7376427640609846
    0.0
    0.035431279967699576
    3.1474211538161354
    0.0
    0.28973814529593117
    1.5726965104447561
    0.0
    0.6714251114873361
    0.0
    0.7518200460909781
    0.0
    0.5491773679473707
    1.3517812769149182
    0.0971282148365062
    0.7310928946912651
    0.0
    0.0
    0.0
    0.06308960674798474
    1.3045480044303996
    0.0
    1.1506785160064659
    1.0329263334190741
    2.543673918266564
    1.0974049261375365
    1.3496494181491454
    0.06700418172740023
    0.4288659792393026
    0.45170111286678927
    1.837089830244555
    0.0
    1.090892390953867
    1.1459578730453712
    0.0
    0.41436973326075954
    1.4901072147442214
    0.9608556499765383
    0.6859712238749737
    0.6017285993410892
    1.027893391836477
    0.6488435803316296
    0.5005381242210217
    0.5706125191941472
    0.501846442064862
    0.13501208403538026
    0.9693320924669061
    1.7663678009291763
    1.406087295508776
    0.34597943575140117
    0.29888969176984803
    1.2666234001975851
    0.0
    0.0
    1.1437003718120746
    0.9667627130586313
    0.1326274582146265
    1.1381777964528867
    1.2026752696914675
    1.198421212202042
    1.2037877087196533
    0.608468575905694
    0.0
    0.4830361159968286
    0.0
    0.7207481045221311
    0.4370887980891759
    2.4571884603751815
    0.5982218034028675
    0.5541912415534547
    0.29143104045302337
    0.7780256249424997
    0.0
    0.9356521363283808
    0.0
    1.7389236357153928
    0.34169336692355035
    0.0
    1.5335173365571975
    0.6032106406245351
    0.8742962847958718
    2.134732554837157
    1.389952855265905
    0.5610779381702904
    0.3127795301780302
    0.2007262043954751
    0.18836715357096298
    0.0
    0.5057930381288269
    0.2509888831883904
    0.33092149563415735
    1.5521631802624176
    0.0
    0.9563469037846418
    0.2197101831901631
    0.0
    0.3714637124902847
    1.441692948479733
    0.18140649466648093
    0.7449491743655084
    1.803576013593998
    0.8941893179809909
    0.0
    0.0
    0.0
    0.0
    0.652621101159587
    0.7763470004008466
    0.6578810429981065
    0.0
    0.01416662002119959
    0.01667801155890401
    0.0
    0.0
    0.3102742761619152
    0.0
    0.9237308958024475
    0.0
    1.0426526858111587
    1.4698791596330727
    0.0
    0.0
    0.8179323340267094
    0.0
    0.14993168542250748
    1.2880650194645855
    0.39982716359141773
    0.33437664288032865
    1.6665965569009276
    0.45072585582202834
    0.9136368809076362
    0.5698465388844292
    1.0088385474211017
    0.0
    1.1281111811782822
    1.377866533037425
    0.8097419713901642
    0.19793187978531657
    0.6850120114514923
    0.0
    0.16237334435244094
    0.0
    0.0
    0.0
    2.3610785543561033
    0.8276641838362716
    0.7561232109776905
    0.5257088774100598
    0.907380678526443
    0.5253292267889704
    0.25446948093827126
    0.0
    0.22642773471636812
    0.8828024535117506
    0.2082012808878747
    0.0
    1.6981007781817388
    0.8044817041425255
    0.0
    0.0
    1.0104324878754565
    0.0
    0.10206128995817368
    1.5246811035354337
    0.7789987186321529
    1.110986507162199
    1.0423777539071408
    0.0
    0.8049313641100011
    0.932088521934744
    1.9050771065758167
    0.08488164602937638
    0.0
    0.5027067254285204
    0.8173020435366165
    0.61296974908613
    0.7842020605219119
    2.7051664578713086
    0.7199583599039873
    0.04265142327889044
    0.4564066847220614
    0.06559461105186093
    0.0
    0.5020572278514849
    0.8607447680025433
    2.178029554772173
    1.185115594989103
    1.2114064381432998
    0.7223912486700161
    1.403521998307592
    0.3902136768064375
    0.3364548750057774
    0.401981789506984
    0.0
    0.4543237560444669
    1.2448766953115595
    0.8607871322997782
    0.9005982344310163
    0.7134947696458623
    1.0036598555018796
    0.3203819049696538
    0.7429246422512353
    0.34317250224091816
    0.24233858565092464
    1.3080847670289077
    0.8690741061146481
    1.7062919741469846
    0.18734424581933648
    0.0
    0.06555828127655268
    0.6102501334043023
    0.35068707571321545
    0.0
    2.0059625121937454
    0.24352099123701326
    0.08817736134347592
    0.0
    0.3747846069352335
    0.8148165779700912
    0.0
    0.11836562374635029
    0.0
    0.2670655404791241
    1.348558467010747
    0.1594579833084913
    0.0
    0.23151342991735874
    1.101274690720897
    0.0
    0.003583535507756008
    0.0
    0.5487045242477505
    0.0
    0.0
    0.4023244844428509
    1.1957141730673881
    0.0
    0.03958457761092101
    0.9279256375588816
    1.130763610617946
    0.9458201566229697
    0.24091742666830043
    0.6482430962720027
    1.0789864187994236
    1.6196387599319053
    0.7471251010385039
    2.1738781910592193
    1.7283052486493116
    0.6697430426575158
    0.20102186839871286
    1.6453406867953624
    0.0
    0.0
    0.0
    0.0
    0.13730322771580655
    0.2695254529928568
    0.0
    0.18922191535132554
    0.05546158753220362
    0.03030239954761072
    0.0
    0.6594531458260361
    0.06388925035766399
    0.5293628599853714
    0.4452215979604001
    1.3036598243353417
    0.7335491187683854
    1.1465828169054437
    0.6001819510085773
    0.757640876614641
    0.8015659240338724
    0.3187069957264297
    0.7124350306683578
    0.5448710802814338
    0.7541727917095252
    0.2680960508078708
    1.008089695171283
    0.80714767263176
    0.981342901850672
    0.0
    2.7103797067530375
    0.0
    0.4519206798646983
    0.844870324184443
    0.0
    0.0
    0.0
    0.605977991363913
    0.7102116596594938
    2.4985081943098977
    1.4186814850255094
    0.0
    1.5693609896313048
    0.0
    0.0
    0.0
    0.17231811750033665
    0.5956901244296016
    1.6440397480058326
    0.0
    1.580751852812343
    2.5007764961758623
    1.445306214715511
    0.7383444195313681
    1.1943697401023283
    0.7421605464508739
    0.0
    1.7497749654083772
    0.9228926114923542
    0.8050397674498146
    0.4900575357472543
    0.9841794738170759
    1.3452284805638985
    0.7180543158315158
    0.4035226267370831
    0.013073971770834952
    0.0
    1.7934989826403582
    1.1884704375200372
    0.033163117993279166
    0.0
    1.3417641888619884
    0.0
    0.0
    1.4334302287737668
    0.41001892651716954
    0.21165499539678828
    1.3475934003521923
    1.1559640381379501
    0.0
    2.1669654813151715
    0.754036000528527
    3.084228814503141
    0.0
    0.1591374329898261
    0.0
    0.8677845498749
    1.1224176566163524
    1.737899623050475
    1.3194561109886935
    0.7726902234196451
    0.0
    0.22434834574165746
    0.25622261135876756
    0.0
    1.6385348103504582
    0.0
    0.09414462455586362
    0.5270365584806109
    0.0
    1.3800167264076908
    1.4684281220676476
    0.0
    0.9207104972535329
    0.20498130175460563
    0.6237183900063473
    1.045856539806957
    0.9911537822491533
    0.24183202185120778
    0.4396287407020645
    0.0
    0.47513016458024027
    0.8068329136937619
    0.0
    0.0
    0.0
    0.0
    0.20011282750336598
    0.7077380586022651
    0.3698193844770222
    0.31179846679647577
    1.150720660041842
    0.3012135761975965
    0.0
    0.4033527167562412
    0.6653539960477386
    0.44870067288093884
    1.3319729715891235
    0.0
    0.669694023998443
    0.0
    2.266394693815267
    0.3508441227099207
    0.9118704973118806
    1.012647723374624
    1.2922191246421244
    0.0
    0.9782696005842113
    0.2797093813973292
    0.0754971926418639
    0.058571743953608923
    0.6410594975471346
    0.0
    0.3230450027952228
    0.9633610999745922
    1.2018751518823054
    1.2292810585235066
    0.9221054542966033
    1.5811469654968633
    0.0
    1.4377443635721263
    0.9605739309493667
    0.0
    0.8183380269835429
    0.8186986295757555
    0.31460061818452123
    0.5061763199327721
    0.0
    1.7028121524200426
    0.4031752865230458
    0.6579684823831357
    1.2064917002311264
    1.4746995581685989
    0.6024119974854809
    0.29042194390538467
    0.0
    0.45030419570806446
    0.24128071226703413
    1.9766284796528806
    0.4482164091179226
    0.0
    0.4541710863266605
    1.2964371694179082
    1.251434546259519
    0.0
    0.7576020641653758
    0.2588937435350621
    0.0
    0.3162106315459725
    1.1203709212609203
    0.17756910672531273
    0.7283630216096865
    0.1411511923755548
    0.46858726160563524
    2.4791680842719237
    1.5257497277517313
    0.20140370265547375
    0.0
    0.08925448585375165
    0.37077938765150237
    0.9974131739830042
    0.7378300723875446
    0.0
    0.0
    0.5455578315275811
    0.8862872322421038
    0.0
    0.0518427675967242
    0.9005870279720791
    0.7973000852266964
    0.0
    1.6188155720967805
    0.07711032746747166
    1.2038764102868893
    1.7492927141008987
    1.226958007574412
    1.0264743724886285
    1.047427137154908
    0.722213770570776
    1.2297806123502848
    1.896351677143632
    2.0674151758028056
    0.8779779327834949
    1.027322331718032
    2.5836910715544543
    0.0
    0.7834376887540014
    0.7360470031148614
    0.23010304901679288
    0.08621229973618033
    0.0022654662042719776
    0.6921444978756657
    0.0
    0.6164101013022889
    1.0908785879238652
    1.348133215753337
    2.0474465196751144
    3.2415297286116274
    0.19801301192247187
    0.7549039831764168
    0.5450264778296458
    1.50663401774106
    0.3717199587296842
    1.070143501687739
    0.0
    1.4859802928513255
    1.8088339973830319
    0.4845287177495383
    0.6382842016613686
    1.2564866492846363
    0.5305555075388945
    0.20626644697539462
    0.9089790449774315
    2.208945125995277
    0.0
    0.7570189440563257
    2.0060474493776064
    0.3600826840790499
    1.2117758389472313
    0.2806816872266235
    0.0
    0.0
    0.642913380395254
    0.3453299682939267
    0.8552210548756205
    0.2756074669644735
    0.8644460892901126
    1.3193566754966282
    0.1549177511412324
    0.31482426478198594
    0.45652798259265837
    0.3720497638982635
    0.0
    1.563919124940453
    0.6792713793044864
    0.0
    1.780286756479792
    0.31126181581878104
    0.13932425566983306
    0.0
    0.7845329547939768
    0.2894240646283848
    0.0
    0.0
    1.4832875351612218
    0.44501864943799924
    0.40478551912611377
    0.441514962535785
    2.0624246979206373
    0.8836576555210954
    1.8859655013886736
    0.0
    1.8744689247374837
    0.0
    0.6348248781165335
    0.0
    0.0
    0.42894642708815073
    0.0
    1.9712395788302874
    1.2733125633085773
    1.4655295956395158
    0.41064041788274075
    1.109189353460991
    0.13067524036136563
    0.0
    0.3937674196358563
    0.7260801385986487
    0.0
    0.05879659420007012
    1.3718681477032657
    1.3081417538190785
    0.9057730609384613
    0.4878948709417043
    0.9692112751345628
    0.04910846775564158
    1.369256484855325
    0.0
    0.0
    0.0
    0.6861768243813635
    0.3396482522409686
    0.3268820846783066
    0.7667539501498878
    1.9325754332305176
    1.1066089082768273
    0.0
    1.289678332217471
    0.27746625117114965
    0.9537428404900855
    0.0
    0.2979473901732385
    0.7281549644289346
    0.1563817017416499
    0.7565159614211007
    0.6068602479800673
    1.0262452210201078
    0.05488783462417142
    1.4190701163067025
    0.8121012556353095
    0.0
    0.6657865430020465
    0.0
    0.17762496979866346
    0.17141067028011545
    0.2133846648390687
    0.16780144243445622
    0.12387263260534495
    0.16135330797658975
    1.7138984752701818
    0.2939493157693425
    0.0
    1.2972941139856995
    3.2628510480155186
    0.41518988039724286
    0.50369945829263
    0.0
    0.0
    0.022002938173545122
    0.04256764891600968
    1.537789616609713
    0.6445179817364375
    1.2591843893618102
    0.14896658742557065
    0.0
    0.4896811622133619
    0.07803823355454989
    0.5934926964795053
    0.0
    0.0
    1.0880852391638383
    1.006040379189683
    2.800515493532827
    0.3185055086021043
    0.75182596949525
    accumulated_time=0.19781756401062012






|

.. code-block:: default

    print(__doc__)
    import time
    import numpy as np
    import matplotlib.pyplot as plt
    import pytransform3d.plot_utils as ppu
    from distance3d import gjk, colliders
    from distance3d import random
    from distance3d import plotting


    random_state = np.random.RandomState(0)
    center, radius = random.rand_sphere(random_state, 0.2, 1.0)

    ax = ppu.make_3d_axis(ax_s=2)

    accumulated_time = 0.0
    for i in range(1000):
        center2, radius2 = random.rand_sphere(random_state, 1.0, 1.0)
        start = time.time()
        s1 = colliders.Sphere(center, radius)
        s2 = colliders.Sphere(center2, radius2)
        dist, closest_point_sphere, closest_point_sphere2, _ = gjk.gjk(s1, s2)
        end = time.time()
        accumulated_time += end - start
        print(dist)
        if i > 5:
            continue
        plotting.plot_segment(
            ax, closest_point_sphere, closest_point_sphere2, c="k", lw=1)
        ppu.plot_sphere(ax, p=center2, radius=radius2, wireframe=False, alpha=0.2)
    print(f"{accumulated_time=}")

    ppu.plot_sphere(
        ax, p=center, radius=radius, color="yellow", wireframe=False, alpha=0.5)
    plt.show()


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  0.421 seconds)


.. _sphx_glr_download__auto_examples_gjk_plot_spheres.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: plot_spheres.py <plot_spheres.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: plot_spheres.ipynb <plot_spheres.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
