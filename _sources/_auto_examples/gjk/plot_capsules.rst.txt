
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "_auto_examples/gjk/plot_capsules.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download__auto_examples_gjk_plot_capsules.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr__auto_examples_gjk_plot_capsules.py:


==================================
Distance between capsules with GJK
==================================

.. GENERATED FROM PYTHON SOURCE LINES 6-52



.. image-sg:: /_auto_examples/gjk/images/sphx_glr_plot_capsules_001.png
   :alt: plot capsules
   :srcset: /_auto_examples/gjk/images/sphx_glr_plot_capsules_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none


    0.5890555392435147
    2.8582144306655963
    0.7481092636203293
    1.0174163554435067
    1.1422249967593072
    0.39557731063764584
    1.4937019553481008
    0.4035503641572139
    1.1406412656283482
    1.315689150040148
    1.3180273943353698
    2.359155478574221
    1.188859951100653
    1.4267379636026993
    0.22536146976796534
    1.6227512929781358
    1.1695927063828977
    0.8427159272834486
    0.9093874822157801
    0.4241518820704791
    0.6439226384833273
    1.1417591729212404
    1.0260954972103933
    0.48448714948075106
    0.9454698188692077
    1.892567017808396
    0.0029481514261572154
    1.597633829220368
    2.0982240841057167
    0.8978354189311983
    1.5240414130867346
    1.6253012184832913
    1.1944357415509486
    2.1565235611529427
    1.2864360470975127
    0.23713492241033018
    0.2940244578592946
    2.2906646142956233
    1.3787010981706433
    0.6141197124358935
    0.6341493564268704
    0.3862898126605357
    1.6265413086620588
    2.5360278654564032
    0.3588288932081576
    1.3004524652803449
    0.5388250564370264
    1.0072809253653934
    1.6453404917343677
    1.1884529198462865
    1.0917954804401584
    0.6754089963223894
    2.627154464205116
    2.6124669569315473
    2.1013545671264793
    1.0751388809091835
    0.0
    1.13631365764358
    1.8759588918137908
    0.802531398797033
    1.3694115407821903
    1.1006694714935277
    1.0007522520825998
    0.5441255371781663
    1.9549685021857568
    1.0725440882709263
    0.7909101910644859
    1.946251157072978
    2.904103211191604
    1.4011953142605227
    1.6628201688556516
    0.7449486565905279
    1.9680326358781781
    1.1570680453608078
    1.1911559601283765
    1.6643363825250264
    1.7062009733092849
    0.4622250581314048
    2.670030674521345
    1.3816180465842272
    2.8209804001294745
    0.3293860665204685
    1.7139558762613387
    1.1042526647789943
    1.3878158800351896
    2.417163412270023
    1.5405273006776181
    2.2132983207153707
    0.9743492017869492
    0.0
    0.25187328721885727
    1.0173503464364373
    0.48688310843989485
    0.6581148051917272
    0.12561402968082636
    0.4959787420476356
    0.270841004138272
    1.1226128527813637
    0.32381645275413495
    0.5924536108960996
    1.0025460464003482
    0.5893365521681561
    1.3137489028554301
    0.6507395973311128
    0.9460486239289246
    2.613109839437573
    1.725416534768387
    1.6548364986192319
    1.6769010844053855
    0.662931179615531
    1.2462761996358693
    0.7162029119690401
    3.0522589301132634
    0.5953366015504788
    1.7740508637279493
    0.050888080436437104
    1.5282370350782284
    1.1265535847241372
    1.8816739719235054
    1.0666348208944452
    2.0200553471939426
    0.7961888129684371
    0.8240961659133712
    0.7293803571068236
    1.3362296952276163
    0.8718611046190294
    0.9386146627038059
    1.181117778683005
    1.3221906693322234
    1.7170783414750368
    0.7560084876283724
    1.1502770828959727
    0.8106074590903257
    0.17641446939958524
    1.6599278517345457
    1.1867366924315956
    2.142304579405093
    0.1875669361984255
    0.5320607042541224
    1.2308600948232507
    1.5802757101451976
    1.6380447531358373
    0.5379328529935534
    1.2011768520606214
    0.3791030274617876
    2.4640496534325824
    0.6346291786575883
    1.4964817641355774
    0.7126151470330154
    3.101913430684449
    1.486410139987557
    1.0361059190723687
    1.1617313039027555
    1.3309523615528358
    1.0895599635222755
    0.7238901454109538
    1.316395334594333
    0.3447671370328763
    1.2875863337174898
    2.8479198706994824
    1.3823112630873682
    0.7307912463726756
    0.7260421458309344
    1.4286867370410585
    0.8826405431855506
    1.6853757015640674
    2.3701819982810717
    2.984109989472141
    0.3165370842719784
    1.39782914276504
    0.541387276241694
    0.41743747574198553
    0.43640923789707137
    0.0
    0.9057529063254255
    2.278056252078674
    0.9776630354772299
    0.7661230888816314
    1.886208644338473
    0.82880045619396
    1.1631042596081538
    0.9958559853478781
    0.45555260202213316
    1.2887464798426118
    0.316214358430426
    1.8612365147309755
    0.9729599612080286
    1.3962234522958474
    1.4875719737107185
    0.8128852322003475
    1.4744066340723214
    0.11420323087414787
    0.6086120841142985
    1.2566173609326259
    0.9733389385122522
    1.3402324117650468
    0.7280064487660666
    1.92113201043876
    1.5618925427230346
    2.995825458518407
    1.1102947004814043
    1.911515473159186
    0.854671500370424
    0.8797476236396188
    1.558544875155406
    1.3135841873477072
    2.0186076286451464
    1.7104526756384288
    1.679599184565368
    0.9437330005601933
    1.7964815650064747
    0.4457065672118219
    1.4211886577599113
    2.5241412351455232
    0.9062372156929026
    0.5666444428910252
    1.9022860731002758
    1.7358540747133966
    0.09614921814292002
    0.14226042155758384
    1.606686979335956
    1.727388890482322
    0.9173207985112021
    0.18349590431485668
    2.1666337505684634
    0.9215678134924118
    1.550358890637605
    1.1021408147234864
    1.4455292259414876
    0.7623893123375016
    2.57246222971912
    0.5661135657175594
    0.4982708897349186
    1.2327537980043999
    2.1466506071269853
    0.8992054469490003
    2.854699886511732
    0.2540529249056807
    1.513154492963325
    1.5259074898428882
    1.2374528019938646
    2.3767220885537053
    1.173249098820395
    1.4645619311234663
    1.8912085120651718
    1.4768738854906758
    2.281396674034344
    2.995815418625353
    0.9633641901217451
    1.5855212368338911
    0.5875020820809029
    0.9466335640070976
    1.651324881838748
    1.2024872707658905
    1.8140647620360113
    1.7052657797942217
    0.7699494321682483
    1.654573981379089
    1.4535599814770899
    1.8570902658139734
    1.7009684083911187
    1.2632215610820752
    0.08884097476881914
    2.4499855486347655
    0.3039772815466451
    1.1770469702060988
    0.23886214047716148
    1.0667957030405515
    0.6929621111918652
    1.6117747987735518
    0.4721268576377108
    0.4329737272422269
    1.5560099339201117
    0.6614177848187764
    0.7091546700355843
    1.0708486379272835
    0.2897603857204926
    1.2726264971002537
    1.3780886939813988
    1.416844401081833
    1.4456750288663758
    3.894444544739273e-17
    0.6138403855160837
    0.6805422574146041
    0.0
    0.9522554940087722
    1.2497594859582424
    1.6646259061877458
    2.8016211831317586
    2.424491349642359
    0.9709924128007416
    0.6774777114100672
    1.1784775063443915
    2.6616512012184637
    0.9752587186894518
    1.164917285761873
    1.1156394511055607
    0.8073188328492561
    1.7186037824092992
    0.7768163719550965
    0.9281118442714563
    0.8610994325793361
    0.4170926327987026
    1.4023863975782107
    1.6986112329431535
    1.401796508934261
    1.097100762753327
    0.6971324853024613
    0.8578843572418694
    1.4858111388399486
    0.8554429149237526
    1.5741333827570405
    1.5823731556827747
    0.9393107110327223
    0.11880201003978459
    0.07070793912691464
    0.12481326799434608
    1.0734626096695308
    0.3332247617314663
    0.8332963739160482
    1.661860359114309
    1.483871557689726
    1.197702474284656
    1.6381710780902925
    0.8515874249633377
    0.8911839840084176
    1.395234086197742
    1.755921807615026
    2.1488275517826967
    1.2249109140963337
    0.42988880313385097
    1.768541408659827
    0.998154528483278
    0.0
    2.026093878078045
    0.759121014041611
    1.7190020250523588
    0.9220872496670033
    1.679026186360866
    1.3458594912553956
    0.8813183284347715
    1.258245642027493
    0.9460005579585483
    1.4106277601251591
    1.7113573314657566
    1.557770478260295
    0.19726985482426412
    0.8673308399019495
    0.9924867600370844
    1.457132111910616
    1.457071657935819
    1.3226535314595431
    1.0298902677558468
    2.6373066892844763
    0.7021821727766137
    2.309599372503392
    1.9056643815512955
    1.3201247460241894
    0.2085247591254313
    1.092558309862493
    2.4686737220252146
    0.5543073634573324
    1.5874140884516104
    0.5643659240200074
    1.9271669681906953
    0.4312558748995818
    1.7841948790951885
    0.33739970090927796
    0.2889187885892454
    1.7581187436231216
    0.9459583388453797
    1.1131041552022825
    1.556079907368944
    0.6105578409064855
    0.43020069140956274
    0.8036240278790429
    1.1971244078455687
    2.202491224133013
    1.2654146627886333
    0.9905978551464627
    1.2729440896688171
    1.7841751393500505
    1.3567452894297576
    1.7336753506776417
    1.1843095099645369
    1.6593704742475863
    1.3745846912777708
    2.394984792408715
    2.0193781560360566
    1.0002996808637683
    0.48301354025091187
    1.4363243310744318
    1.2951892162963934
    2.6980557331931188
    2.0528804477185494
    0.9403461469290073
    0.5880066955587807
    1.8723311747529072
    1.39604612872117
    1.084258742429252
    1.4377869409386685
    2.4215842131279226
    0.7773533522753959
    0.3990198317660482
    1.3693547579669987
    1.894198056153844
    0.7376326116430342
    1.8470897329788705
    1.2709542171938755
    2.025265381793229
    0.845192579099202
    1.807758751404301
    0.952375721302756
    1.3996609653270693
    0.44089230605746627
    0.8521480371145865
    1.6207310006541455
    0.6414093620442753
    1.3783823687068073
    1.4300924687957934
    0.541400886401615
    0.36797436959616175
    1.7392324993578632
    0.13656841311740178
    1.3266994822177323
    1.8784747039260417
    2.0655720664110446
    0.9107554187537161
    0.8123867647313762
    3.190415756099569
    0.6346636368037043
    1.2307309317856532
    0.9210940880434226
    2.395567360594619
    1.4435339305262131
    1.469903799593118
    1.0159774891081232
    1.2008910365791834
    0.9680106606831593
    1.2851162107140848
    1.337279366974643
    1.379263438260794
    1.5037846077750638
    1.6889973907851825
    1.2883277516900593
    1.7739639506256792
    0.745966900479551
    0.47076135414297915
    1.730969593287481
    0.09501984885696224
    1.5141829500921908
    0.92638859809833
    0.5540092636225005
    0.0480455602404446
    0.8070619812872293
    0.5503837301397341
    1.6411044985934546
    1.5831092215765523
    2.055594498029898
    1.188810708988287
    0.8224066650473058
    0.555298334706519
    1.1867618206772828
    1.7006925539747377
    1.275859405301317
    1.2069463640498759
    1.7442762003862595
    0.5306346253570283
    1.2333215562876896
    1.7784916438343263
    1.6571857458058978
    1.6183822052032555
    0.348476360542926
    0.954074127794744
    0.4122160449911241
    1.2986963046722337
    2.6707493937852806
    0.8565530194543924
    2.1044089821615466
    2.5944069432080936
    1.488396815775675
    2.4494972141594658
    0.46391940845195306
    1.9407444477092204
    1.0456971906910077
    2.0656881760312276
    1.119630848564177
    0.8426487748430056
    1.1547749267651688
    1.6283377859779355
    1.3832507878461695
    0.7936375792879645
    1.3946304260259819
    1.4323043473977386
    1.4611018393615633
    1.8723979682231087
    1.1518074964802747
    1.4112089582543195
    0.7990365631051232
    1.4436613341119817
    0.0
    1.5140208177435532
    1.1985591215397935
    1.0195331557419625
    1.390977320844598
    0.5788597411881337
    1.5802527895014293
    0.22414654412958804
    1.8114383836517074
    2.1948028914325164
    1.404655101163683
    1.5007475135835107
    1.3617402961323708
    0.9607497093863734
    0.9034496528520205
    0.9518932613212728
    0.7751290245074959
    0.6990815425279641
    1.680938641683007
    0.7392146761909052
    2.0146145576433234
    3.159599255648011
    0.5211891346558747
    0.47461039244112957
    1.3290812537708254
    1.5040724667959222
    1.8681521413392996
    0.8745286799878305
    1.517552401446146
    1.2507068826181642
    0.7684599928942135
    3.275406743269355
    1.0150021450237734
    1.1534014209596222
    0.7140948549236162
    1.3122498807725103
    2.009430704256282
    0.6359039079780092
    1.0876382406269929
    0.7390722594926724
    0.7533006313339364
    2.1913024994469077
    1.968321969119509
    0.9622235790699772
    1.419947305141916
    1.8684869534960322
    1.1723287532946631
    1.1798495050848514
    0.4241515527748404
    2.4364616168993014
    0.6001868869871424
    0.6949639644525876
    2.4418249380089767
    1.1699917495778926
    0.05657831009407154
    2.544103168677973
    1.461802487007397
    1.1200538069468224
    1.1907851676007166
    1.277036832777202
    0.7067509488768162
    0.9350967538093123
    1.6380270317931982
    1.360959996217567
    1.7756903058538256
    0.6746174760431103
    1.0630738719770985
    1.0329379249892048
    0.9846744159552064
    1.4228684612307658
    1.0457538325896045
    1.5410304980150713
    2.7347167743375214
    1.5623988361810375
    0.9579864600217162
    0.0
    0.14363362183549758
    1.3763709297641844
    1.9381869695654999
    1.4623621842980332
    1.4176452072033807
    1.3124960442037568
    0.3987939519845537
    1.3371555614361035
    1.2045193163402537
    1.2486640872244297
    0.0
    1.0379571222201618
    1.3494145427596482
    1.1643637617336806
    2.6013970474849404
    0.7278357198831829
    0.8128530068828419
    0.8174835227845665
    1.2457116197961313
    1.1329232228317183
    1.6719374759341228
    1.6438450540647
    1.647872134855436
    0.9040876390975662
    1.2228535503325162
    1.2996234573062058
    1.5745775232042367
    1.16148357714792
    1.6916254706253968
    1.3864013278655702
    1.2786854944858965
    1.7768429986778445
    1.31931488058738
    0.5672934856018652
    2.313337206034805
    1.5304253302506527
    0.83949490364777
    0.9160651406469285
    1.4514650375696372
    0.9376841372053156
    1.2407754413832244
    0.9541519288110533
    1.421468846935401
    1.6550214154530791
    1.7438306966592496
    1.6940101452695249
    0.6937858591547387
    2.7354347610457306
    0.8050790699764889
    1.2096872433604784
    0.4777022673160213
    2.3692618784993957
    0.583344693439558
    0.8396616397424316
    0.572458018451947
    1.3791742229839932
    0.9870385371471286
    0.9652001789175852
    0.9064377784866677
    1.0053483743004923
    2.7445573532650656
    2.7194120136944324
    1.1946101082332399
    1.0856089832017977
    1.6770393334768183
    1.0966114384394479
    1.0214339069642502
    1.277975964688363
    2.0205392516696534
    1.3417660647493006
    2.3210133787718736
    2.2415506925473623
    0.883288147446523
    0.6890099501625756
    1.2174701240959227
    1.9550782321079057
    0.0
    0.7462881657064206
    1.3464925018243894
    1.0635334382335253
    2.0567168513899854
    0.753730534741135
    0.38720126908385705
    2.2423441963659254
    2.0798050054736708
    2.2274861753459976
    1.989665943626557
    1.4581369007762714
    1.9842444994115767
    0.800966305687123
    0.8712454745138085
    0.6181850055066797
    0.1275101767404479
    1.778061751648615
    2.3958237324913165
    1.7518123411806596
    1.3796790669140355
    2.642213897792253
    1.2884508419436704
    1.8430945096637938
    0.7919542624785758
    2.103497822795171
    1.0431026211022645
    1.7661833515566068
    0.5515432219545819
    1.1696358993618228
    0.0
    0.33868578121860715
    2.2350568426660034
    2.120089614867242
    0.07325249751347863
    0.7388872103192968
    0.4718742664115014
    0.694790318790148
    1.553627579857914
    1.1469627427974842
    0.4238412596733685
    1.2854433396936102
    2.3189051301875727
    1.9313652810587525
    1.142716439230313
    1.2688826398909474
    1.2616521397308176
    0.5251256384740598
    accumulated_time=0.6386494636535645






|

.. code-block:: default

    print(__doc__)
    import time
    import numpy as np
    import matplotlib.pyplot as plt
    import pytransform3d.plot_utils as ppu
    import pytransform3d.transformations as pt
    from distance3d import gjk, colliders
    from distance3d import random
    from distance3d import plotting


    random_state = np.random.RandomState(0)
    capsule2origin, radius, height = random.rand_capsule(random_state, 0.2, 0.4, 1.0)

    ax = ppu.make_3d_axis(ax_s=2)

    accumulated_time = 0.0
    for i in range(700):
        capsule2origin2, radius2, height2 = random.rand_capsule(random_state, 1.0, 0.3, 1.0)
        start = time.time()
        c1 = colliders.Capsule(capsule2origin, radius, height)
        c2 = colliders.Capsule(capsule2origin2, radius2, height2)
        dist, contact_point_capsule, contact_point_capsule2, _ = gjk.gjk_with_simplex(c1, c2)
        end = time.time()
        accumulated_time += end - start
        print(dist)
        if i > 5:
            continue
        if i == 0:
            vertices1 = np.array(c1.vertices_)
            ax.scatter(vertices1[:, 0], vertices1[:, 1], vertices1[:, 2], color="r")
            vertices2 = np.array(c2.vertices_)
            ax.scatter(vertices2[:, 0], vertices2[:, 1], vertices2[:, 2], color="g")
        plotting.plot_segment(
            ax, contact_point_capsule, contact_point_capsule2, c="k", lw=1)
        pt.plot_transform(ax=ax, A2B=capsule2origin2, s=0.1)
        ppu.plot_capsule(
            ax=ax, A2B=capsule2origin2, radius=radius2, height=height2,
            wireframe=False, alpha=0.5)
    print(f"{accumulated_time=}")

    pt.plot_transform(ax=ax, A2B=capsule2origin, s=0.1)
    ppu.plot_capsule(
        ax=ax, A2B=capsule2origin, radius=radius, height=height, wireframe=False,
        alpha=0.5, color="yellow")
    plt.show()


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  0.887 seconds)


.. _sphx_glr_download__auto_examples_gjk_plot_capsules.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: plot_capsules.py <plot_capsules.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: plot_capsules.ipynb <plot_capsules.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
